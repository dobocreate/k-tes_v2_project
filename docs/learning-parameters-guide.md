# 学習パラメータガイド

このドキュメントでは、トンネル地山評価システムの機械学習で使用される各パラメータについて説明します。

## 学習パラメータの詳細

### 1. 葉の数（Number of Leaves）
- **デフォルト値**: 31
- **範囲**: 10～100
- **説明**: 
  - LightGBMの決定木における葉（リーフ）の最大数を指定します
  - 値が大きいほど、より複雑なパターンを学習できますが、過学習のリスクも増加します
  - トンネル地山評価では、支保パターンの微妙な違いを捉えるために適度な複雑さが必要です

### 2. 特徴量サンプリング率（Feature Fraction）
- **デフォルト値**: 0.9（90%）
- **範囲**: 0.5～1.0
- **説明**:
  - 各決定木を構築する際に使用する特徴量（穿孔パラメータ）の割合
  - 例：0.9の場合、各木で全特徴量の90%をランダムに選択して使用
  - ランダムサンプリングにより、モデルの汎化性能が向上し、過学習を防ぎます
  - 穿孔エネルギー、回転圧、打撃圧などの特徴量から一部を選択することで、より頑健なモデルを構築

### 3. 学習率（Learning Rate）
- **デフォルト値**: 0.05
- **範囲**: 0.001～0.3
- **説明**:
  - 各反復での学習の更新幅を制御
  - 小さい値：より慎重に学習し、安定した結果が得られますが、学習時間が長くなります
  - 大きい値：学習は速くなりますが、最適解を見逃す可能性があります

### 4. データサンプリング率（Bagging Fraction）
- **デフォルト値**: 0.8（80%）
- **範囲**: 0.5～1.0
- **説明**:
  - 各決定木で使用する学習データの割合
  - バギング（Bootstrap Aggregating）により、モデルの安定性が向上

### 5. クロスバリデーション分割数（CV Folds）
- **デフォルト値**: 5
- **範囲**: 2～10
- **説明**:
  - データを何分割して交差検証を行うかを指定
  - 各分割で異なる部分をテストデータとして使用し、モデルの汎化性能を評価

### 6. テストデータの割合（Test Size）
- **デフォルト値**: 0.2（20%）
- **範囲**: 0.1～0.5
- **説明**:
  - 最終的なモデル評価用に確保するデータの割合
  - 学習に使用しないデータでモデルの性能を検証

## 学習進捗表示ボタンの機能

「学習進捗を表示」ボタンは以下の情報を提供します：

1. **学習中の情報**:
   - 現在のステップ（データ準備、モデル学習、保存など）
   - 進捗率（0～100%）
   - 処理中のメッセージ

2. **学習完了後の情報**:
   - テスト精度：最終的なモデルの予測精度
   - CV平均スコア：クロスバリデーションの平均精度
   - CV標準偏差：クロスバリデーションのばらつき
   - 学習結果の可視化（混同行列、特徴量重要度など）

## 推奨設定

### 初期学習時
- デフォルト値をそのまま使用することを推奨
- データ量が少ない場合は、葉の数を20程度に減らす

### 精度向上を目指す場合
- 学習率を0.03に下げて、より慎重に学習
- クロスバリデーション分割数を7～10に増やす

### 過学習が疑われる場合
- 葉の数を15～20に減らす
- 特徴量サンプリング率を0.7～0.8に下げる
- データサンプリング率を0.6～0.7に下げる